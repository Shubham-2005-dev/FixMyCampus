<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FixMyCampus - Student Dashboard</title>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --bg-gradient: linear-gradient(135deg, #667eea, #764ba2);
      --card-bg: rgba(255,255,255,0.9);
      --text-color: #333;
      --subtext-color: #666;
      --border-color: #ddd;
      --footer-bg: rgba(255,255,255,0.85);
      --btn-bg: #4285f4;
      --btn-hover: #3367d6;
    }

    body.dark {
      --bg-gradient: linear-gradient(135deg, #1e1e2f, #121212);
      --card-bg: rgba(30,30,30,0.9);
      --text-color: #f1f1f1;
      --subtext-color: #bbb;
      --border-color: #444;
      --footer-bg: rgba(20,20,20,0.9);
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-gradient);
      color: var(--text-color);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .container {
      max-width: 1200px;
      margin: auto;
      padding: 20px;
      flex: 1;
    }

    header {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
      margin-bottom: 30px;
      text-align: center;
      position: relative;
    }

    header h1 {
      margin: 0;
      font-size: 2.5em;
    }

    /* Dark mode toggle */
    .toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      cursor: pointer;
      background: var(--card-bg);
      padding: 10px 14px;
      border-radius: 50px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
    }

    @media (max-width: 900px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: var(--card-bg);
      border-radius: 18px;
      padding: 25px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }

    h3 {
      margin-top: 0;
    }

    /* INPUT FIXED */
    #issue {
      width: 100%;
      padding: 14px 18px;
      border-radius: 30px;
      border: 1px solid var(--border-color);
      font-size: 16px;
      margin-bottom: 15px;
      background: transparent;
      color: var(--text-color);
      box-sizing: border-box;
    }

    #image {
  width: 100%;
  padding: 14px 18px;
  height: 52px;               /* SAME height as text input */
  border-radius: 30px;
  border: 1px solid var(--border-color);
  background: transparent;
  margin-bottom: 15px;
  cursor: pointer;
  font-size: 16px;
  color: var(--text-color);
  box-sizing: border-box;
}

/* FIX default "Choose File" button */
#image::file-selector-button {
  background: var(--btn-bg);
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;            /* MATCH input text size */
  cursor: pointer;
  margin-right: 10px;
}

#image::file-selector-button:hover {
  background: var(--btn-hover);
}

    #submit {
      background-color: var(--btn-bg);
      color: white;
      border: none;
      padding: 14px 30px;
      border-radius: 30px;
      font-size: 16px;
      cursor: pointer;
    }

    #submit:hover {
      background-color: var(--btn-hover);
    }

    #history {
      margin-top: 10px;
      max-height: 260px;
      overflow-y: auto;
    }

    footer {
      text-align: center;
      padding: 12px;
      background: var(--footer-bg);
      font-size: 14px;
      color: var(--subtext-color);
    }

    .logout{
      position:absolute;
      left:20px;
      top:20px;
      background:#e74c3c;
      color:white;
      border:none;
      padding:8px 16px;
      border-radius:20px;
      cursor:pointer;
    }
    .logout:hover{ background:#c0392b; }

    #downloadPdf:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }

      header h1 {
        font-size: 1.8rem;
      }

      .card {
        padding: 18px;
      }

      #issue {
        font-size: 15px;
      }

      button, #image {
        width: 100%;
        margin-top: 10px;
      }

      .logout {
        position: static;
        margin-bottom: 12px;
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <button id="logoutBtn" class="logout">Logout</button>
      <h1><i class="fa-solid fa-school"></i> FixMyCampus</h1>
      <div class="toggle" id="themeToggle">
        <i class="fa-solid fa-moon"></i>
      </div>
    </header>

    <div class="grid">

      <!-- REPORT ISSUE -->
      <div class="card">
        <h3><i class="fa-solid fa-wrench"></i> Report Maintenance Issue</h3>
        <input type="text" id="issue" placeholder="Describe the problem">
        
        <!-- IMAGE UPLOAD BUTTON -->
        <input type="file" id="image" accept="image/*">

        <button id="submit">Submit Issue</button>
        <p id="msg"></p>
      </div>

      <!-- PIE CHART -->
      <div class="card">
        <h3><i class="fa-solid fa-chart-pie"></i> Issue Status</h3>
        <canvas id="issueChart"></canvas>
      </div>

      <!-- HISTORY -->
      <div class="card" style="grid-column: span 2;">
        <h3><i class="fa-solid fa-clock-rotate-left"></i> Your History</h3>
        <button id="downloadPdf">Download PDF</button>
        <select id="statusFilter">
          <option value="ALL">All</option>
          <option value="Pending">Pending</option>
          <option value="Resolved">Resolved</option>
          <option value="Rejected">Rejected</option>
        </select>

        <div id="history"></div>
      </div>

    </div>
  </div>

  <footer>
    <p>&copy; 2026 FixMyCampus. Empowering students to improve their campus.</p>
  </footer>

  <!-- DARK MODE SYNC -->
  <script>
    const toggle = document.getElementById("themeToggle");
    const body = document.body;
    const icon = toggle.querySelector("i");

    if (localStorage.getItem("theme") === "dark") {
      body.classList.add("dark");
      icon.classList.replace("fa-moon", "fa-sun");
    }

    toggle.addEventListener("click", () => {
      body.classList.toggle("dark");
      const isDark = body.classList.contains("dark");
      icon.classList.toggle("fa-moon", !isDark);
      icon.classList.toggle("fa-sun", isDark);
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });
  </script>

  <!-- STUDENT LOGIC -->
  <script type="module" src="./student.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</body>
</html>
